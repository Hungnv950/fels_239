<div class="container">
  <div class="panel panel-success">
    <div class="panel-heading">
      <p class="col-md-11">
        <%= t "word.all" %>
        <i> <%= @category ? ": "+@category.name : t("word.all_word") %></i>
      </p>
      <input class="form-control" id="myInput" type="text" placeholder="Search..">
      <% unless action_name == "words" %>
        <%= link_to lessons_url(:category_id => @category.id),
          method: :post, class: "btn btn-primary" do %>
          <span class="glyphicon glyphicon-play"></span> <%= t "lesson.start" %>
        <% end %>
      <% end %>
    </div>
    <div class="panel-body">
      <% if @words.nil? || @words.empty? %>
        <%= t "word.nil" %>
      <% else %>
        <table class="table table-striped table-inverse" id="myTable">
          <thead>
            <tr class="center" >
              <th class="center" ><%= t "word.index" %></th>
              <th class="center" id="id01" ><%= t "word.words" %></th>
              <th class="center" ><%= t "word.answer" %></th>
              <th class="center col-md-2">
                <span class="dropdown">
                  <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                    <%= t "word.category" %>
                    <span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu">
                      <li>
                        <%= link_to words_url(
                          :category => "",
                            :search => params[:search]) do %>
                          <%= t "category.all_category" %>
                        <% end %>
                      </li>
                      <% @categories_search.each do |category|%>
                        <li>
                          <%= link_to words_url(
                            :category => category.id,
                              :search => params[:search]) do %>
                            <%= category.name %>
                          <% end %>
                        </li>
                      <% end %>
                  </ul>
                </span>
              </th>
              <th class="center" ><%= t "user.learned" %></th>
            </tr>
          </thead>
          <tbody class="center" >
            <% @words.each_with_index do |word, index| %>
              <%= render partial: "word", locals:
                {word: word, index: index} %>
            <% end %>
          </tbody>
      <% end %>
      </table>
      <div class="center">
        <%= paginate @words %>
      </div>
    </div>
  </div>
</div>

<script>
$(document).ready(function(){
  $("#myInput").on("keyup", function() {
    var value = $(this).val().toLowerCase();
    $("#myTable tr").filter(function() {
      $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    });
  });
});
</script>

<script>
function sortTable(n) {
  var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
  table = document.getElementById("myTable2");
  switching = true;
  dir = "asc";
  while (switching) {
    switching = false;
    rows = table.getElementsByTagName("TR");
    for (i = 1; i < (rows.length - 1); i++) {
      shouldSwitch = false;
      x = rows[i].getElementsByTagName("TD")[n];
      y = rows[i + 1].getElementsByTagName("TD")[n];
      if (dir == "asc") {
        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
          shouldSwitch= true;
          break;
        }
      } else if (dir == "desc") {
        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
          shouldSwitch= true;
          break;
        }
      }
    }
    if (shouldSwitch) {
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
      switchcount ++;
    } else {
      if (switchcount == 0 && dir == "asc") {
        dir = "desc";
        switching = true;
      }
    }
  }
}
</script>
